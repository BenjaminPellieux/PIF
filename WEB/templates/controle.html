<!DOCTYPE html>
<html>
<head>
    <title>Contrôle_véhicule - Projet PIF (robot trieur de déchets)</title>
   	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
	<link rel="stylesheet" type="text/css" href="/static/text.css">
	<style>
        body {
    		background-image: url('../static/image_controle_vehicule.jpg');
    		background-size: cover;
    		background-repeat: no-repeat;
	}
    </style>
</head>
<header>
    <ul class="menu"> 
		<li><a href="/">Accueil</a></li>
        <li><a href="vision">Vision</a></li>
        <li><a href="gps">GPS</a></li>
        <li><a href="aspiration">Aspiration</a></li>
        <li><a href="controle">Contrôle du véhicule</a></li>
    </ul>
</header>
<body>
    <h1><em>Bienvenue sur la page de contrôle du véhicule</em></h1>
    <style>
    	h1 em {
    	color: white
    	}
     	button {
            font-size: 24px; /* Ajuste la taille du texte */
            padding: 15px 30px; /* Ajuste l'espace autour du texte */
        }
    </style>
    	<div id="map" style="width: 50%; height: 400px;"></div>
    	<script>

	</script>
	    
	<h2>Contrôle directionnel </h2>

	<table style="width:50%; height:20%">
  	<tr>
	  <th><img name="FL" onclick="command(this)" src="/static/forward_left.png"/></th>
	  <th><img name="F"  onclick="command(this)" src="/static/forward.png" /></th>
	  <th><img name="FR" onclick="command(this)" src="/static/forward_right.png" /></th>

	</tr>
	<tr>
	  <th><img name="L"    onclick="command(this)" src="/static/left.png" /></th>
	  <th><img name="STOP" onclick="command(this)" src="/static/stop.png" width="150" height="150" /></th>
	  <th><img name="R"    onclick="command(this)" src="/static/right.png" /></th>

	</tr>
	<tr>
	  <th><img name="BL" onclick="command(this)" src="/static/back_left.png" /></th>
	  <th><img name="B"  onclick="command(this)" src="/static/back.png" /></th>
	  <th><img name="BR" onclick="command(this)" src="/static/back_right.png" /></th>

	</tr>
	</table>

</body>
</html>
<script type="text/javascript">
	var map = L.map('map').setView([0, 0], 18); // Réglage initial de la carte 
	//Ajoutez une couche OpenStreetMap : Utilisez la couche TileLayer de Leaflet pour afficher la carte OpenStreetMap.
	L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
	}).addTo(map);
	var marker = L.marker([0, 0]).addTo(map);

	function updateMarker(lat, lng) {
    		marker.setLatLng([lat, lng]).update();
    		map.setView([lat, lng], map.getZoom());
	}			

	// Simulez la réception de nouvelles données GPS toutes les 2 secondes
	setInterval(function() {
    	// Remplacez les valeurs par vos données GPS en temps réel
			// Coordonnée de L'ISTY !!!
    		var newLat = 48.98479706310472; 
    		var newLng = 1.7016915401253376;
		updateMarker(newLat, newLng);
	}, 500);
    	
	function command(e) {
		console.log("[DEBUG] Name command: "  +e.name);
        	$.post( "/command", {
		    javascript_data: e.name 
		});
    }

        
	if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var accuracy = position.coords.accuracy;
        	$.post( "/locate", {
		        lat: latitude,
                lon: longitude,
                acc: accuracy  
		    });    
            // Faites ce que vous voulez avec les coordonnées GPS ici
        });
    } else {
        console.log("La géolocalisation n'est pas prise en charge par ce navigateur.");
    }
</script>


